<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Post-Campaign Narrative | A minimal Hugo website</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Post-Campaign Narrative</span></h1>
<h2 class="author">Avi Agarwal</h2>
<h2 class="date">2024/12/10</h2>
</div>

<main>
<script src="https://example.org/post/2024/12/10/post-campaign-narrative/index_files/kePrint/kePrint.js"></script>
<link href="https://example.org/post/2024/12/10/post-campaign-narrative/index_files/lightable/lightable.css" rel="stylesheet" />
<pre><code class="language-r">library(dplyr)
</code></pre>
<pre><code>## 
## Attaching package: 'dplyr'
</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag
</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
</code></pre>
<pre><code class="language-r">library(tidytext)
</code></pre>
<pre><code>## Warning: package 'tidytext' was built under R version 4.3.3
</code></pre>
<pre><code class="language-r">library(ggplot2)
</code></pre>
<pre><code>## Warning: package 'ggplot2' was built under R version 4.3.3
</code></pre>
<pre><code class="language-r">library(knitr)
library(kableExtra)
</code></pre>
<pre><code>## Warning: package 'kableExtra' was built under R version 4.3.3
</code></pre>
<pre><code>## 
## Attaching package: 'kableExtra'
</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     group_rows
</code></pre>
<pre><code class="language-r">library(stopwords)
</code></pre>
<pre><code>## Warning: package 'stopwords' was built under R version 4.3.3
</code></pre>
<pre><code class="language-r">library(tidyverse)
</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ lubridate 1.9.3     ✔ tibble    3.2.1
## ✔ purrr     1.0.2     ✔ tidyr     1.3.0
## ✔ readr     2.1.5
</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter()          masks stats::filter()
## ✖ kableExtra::group_rows() masks dplyr::group_rows()
## ✖ dplyr::lag()             masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
</code></pre>
<pre><code class="language-r">categories &lt;- list(
  #used ai to help generate this
  Economy = c(
    &quot;economy&quot;, &quot;jobs&quot;, &quot;employment&quot;, &quot;trade&quot;, &quot;market&quot;, &quot;budget&quot;, &quot;tax&quot;, 
    &quot;spending&quot;, &quot;inflation&quot;, &quot;growth&quot;, &quot;investment&quot;, &quot;industry&quot;, &quot;financial&quot;, 
    &quot;business&quot;, &quot;revenue&quot;, &quot;profits&quot;, &quot;income&quot;, &quot;poverty&quot;, &quot;deficit&quot;, 
    &quot;wages&quot;, &quot;regulation&quot;, &quot;commerce&quot;, &quot;productivity&quot;, &quot;fiscal&quot;, &quot;monetary&quot;, 
    &quot;debt&quot;, &quot;surplus&quot;, &quot;credit&quot;, &quot;loans&quot;, &quot;exports&quot;, &quot;imports&quot;, &quot;capital&quot;, 
    &quot;enterprises&quot;, &quot;subsidies&quot;, &quot;tariffs&quot;, &quot;economic&quot;, &quot;stocks&quot;, &quot;bonds&quot;, 
    &quot;banking&quot;, &quot;insurance&quot;, &quot;costs&quot;, &quot;prices&quot;, &quot;markets&quot;, &quot;profits&quot;, 
    &quot;commodities&quot;, &quot;wealth&quot;, &quot;gross&quot;, &quot;domestic&quot;, &quot;product&quot;
  ),
  Domestic_Policy = c(
    &quot;healthcare&quot;, &quot;education&quot;, &quot;immigration&quot;, &quot;infrastructure&quot;, &quot;housing&quot;, 
    &quot;crime&quot;, &quot;police&quot;, &quot;justice&quot;, &quot;schools&quot;, &quot;teachers&quot;, &quot;students&quot;, 
    &quot;citizenship&quot;, &quot;border&quot;, &quot;roads&quot;, &quot;transportation&quot;, &quot;energy&quot;, &quot;environment&quot;, 
    &quot;climate&quot;, &quot;clean&quot;, &quot;water&quot;, &quot;electricity&quot;, &quot;family&quot;, &quot;welfare&quot;, 
    &quot;childcare&quot;, &quot;labor&quot;, &quot;workers&quot;, &quot;unions&quot;, &quot;safety&quot;, &quot;pensions&quot;, &quot;benefits&quot;, 
    &quot;medicaid&quot;, &quot;medicare&quot;, &quot;security&quot;, &quot;employment&quot;, &quot;poverty&quot;, &quot;urban&quot;, 
    &quot;rural&quot;, &quot;public&quot;, &quot;health&quot;, &quot;infrastructure&quot;, &quot;renewable&quot;, &quot;recycling&quot;, 
    &quot;carbon&quot;, &quot;emissions&quot;, &quot;forests&quot;, &quot;wildlife&quot;, &quot;discrimination&quot;, &quot;diversity&quot;, 
    &quot;equality&quot;, &quot;justice&quot;, &quot;laws&quot;, &quot;legislation&quot;, &quot;marriage&quot;, &quot;civil&quot;, &quot;rights&quot;, 
    &quot;affordable&quot;, &quot;housing&quot;, &quot;crime&quot;, &quot;violence&quot;, &quot;addiction&quot;, &quot;mental&quot;, &quot;health&quot;
  ),
  Foreign_Policy = c(
    &quot;foreign&quot;, &quot;defense&quot;, &quot;war&quot;, &quot;allies&quot;, &quot;diplomacy&quot;, &quot;nuclear&quot;, 
    &quot;security&quot;, &quot;military&quot;, &quot;troops&quot;, &quot;peace&quot;, &quot;terrorism&quot;, &quot;global&quot;, 
    &quot;treaty&quot;, &quot;international&quot;, &quot;relations&quot;, &quot;sanctions&quot;, &quot;conflict&quot;, 
    &quot;weapons&quot;, &quot;strategy&quot;, &quot;border&quot;, &quot;aid&quot;, &quot;humanitarian&quot;, &quot;refugees&quot;, 
    &quot;geopolitics&quot;, &quot;espionage&quot;, &quot;intelligence&quot;, &quot;alliances&quot;, &quot;cooperation&quot;, 
    &quot;trade&quot;, &quot;sanctions&quot;, &quot;blockades&quot;, &quot;proliferation&quot;, &quot;arms&quot;, &quot;embassies&quot;, 
    &quot;ambassadors&quot;, &quot;UN&quot;, &quot;NATO&quot;, &quot;treaties&quot;, &quot;diplomatic&quot;, &quot;sovereignty&quot;, 
    &quot;negotiations&quot;, &quot;peacekeeping&quot;, &quot;hostilities&quot;, &quot;intervention&quot;, &quot;coalition&quot;
  ),
  Character = c(
    &quot;dishonesty&quot;, &quot;corruption&quot;, &quot;incompetence&quot;, &quot;arrogance&quot;, &quot;greed&quot;, &quot;selfishness&quot;, 
    &quot;cowardice&quot;, &quot;hypocrisy&quot;, &quot;deception&quot;, &quot;unethical&quot;, &quot;irresponsibility&quot;, 
    &quot;failure&quot;, &quot;indecisive&quot;, &quot;untrustworthy&quot;, &quot;lazy&quot;, &quot;ignorance&quot;, 
    &quot;prejudice&quot;, &quot;unreliable&quot;, &quot;manipulative&quot;, &quot;biased&quot;, &quot;unaccountable&quot;, 
    &quot;apathetic&quot;, &quot;opportunistic&quot;, &quot;exploitative&quot;, &quot;immoral&quot;, &quot;manipulation&quot;, 
    &quot;abuse&quot;, &quot;cruelty&quot;, &quot;dishonor&quot;, &quot;vindictive&quot;, &quot;corrupt&quot;, &quot;reckless&quot;, 
    &quot;shortsighted&quot;, &quot;intolerant&quot;, &quot;narrowminded&quot;, &quot;greedy&quot;, &quot;tyrannical&quot;, 
    &quot;unethical&quot;, &quot;exploit&quot;, &quot;deceitful&quot;, &quot;spiteful&quot;, &quot;bigoted&quot;, &quot;self-centered&quot;, 
    &quot;authoritarian&quot;, &quot;irresponsible&quot;, &quot;hypocritical&quot;, &quot;abusive&quot;
  )
)
</code></pre>
<pre><code class="language-r">harris &lt;- readLines(&quot;New folder (4)/Harris-10-31.txt&quot;)
</code></pre>
<pre><code>## Warning in readLines(&quot;New folder (4)/Harris-10-31.txt&quot;): incomplete final line
## found on 'New folder (4)/Harris-10-31.txt'
</code></pre>
<pre><code class="language-r">gallego &lt;- readLines(&quot;New folder (4)/Gallego-10-31.txt&quot;)
</code></pre>
<pre><code>## Warning in readLines(&quot;New folder (4)/Gallego-10-31.txt&quot;): incomplete final line
## found on 'New folder (4)/Gallego-10-31.txt'
</code></pre>
<pre><code class="language-r">lake &lt;- readLines(&quot;New folder (4)/Lake-10-24.txt&quot;)
</code></pre>
<pre><code>## Warning in readLines(&quot;New folder (4)/Lake-10-24.txt&quot;): incomplete final line
## found on 'New folder (4)/Lake-10-24.txt'
</code></pre>
<pre><code class="language-r">trump &lt;- readLines(&quot;New folder (4)/Trump-10-24.txt&quot;)
</code></pre>
<pre><code>## Warning in readLines(&quot;New folder (4)/Trump-10-24.txt&quot;): incomplete final line
## found on 'New folder (4)/Trump-10-24.txt'
</code></pre>
<pre><code class="language-r">harris_text &lt;- paste(harris, collapse = &quot; &quot;)
gallego_text &lt;- paste(gallego, collapse = &quot; &quot;)
lake_text &lt;- paste(lake, collapse = &quot; &quot;)
trump_text &lt;- paste(trump, collapse = &quot; &quot;)

speeches &lt;- data.frame(
  speaker = c(&quot;Harris&quot;, &quot;Gallego&quot;, &quot;Lake&quot;, &quot;Trump&quot;),
  text = c(harris_text, gallego_text, lake_text, trump_text),
  stringsAsFactors = FALSE
)
</code></pre>
<pre><code class="language-r">tokenized_speeches &lt;- speeches %&gt;%
  unnest_tokens(word, text) %&gt;%                   
  filter(nchar(word) &gt;= 3) %&gt;%                
  mutate(word = tolower(word)) %&gt;%             
  filter(!word %in% stopwords(&quot;en&quot;))           
</code></pre>
<pre><code class="language-r">categorize_word &lt;- function(word, categories) {
  for (category in names(categories)) {
    if (word %in% categories[[category]]) {
      return(category)
    }
  }
  return(&quot;Other&quot;) 
}

categorized_words &lt;- tokenized_speeches %&gt;%
  mutate(category = sapply(word, categorize_word, categories = categories))
</code></pre>
<pre><code class="language-r">summary_by_category &lt;- categorized_words %&gt;%
  group_by(speaker, category) %&gt;%
  summarise(word_count = n(), .groups = &quot;drop&quot;) %&gt;%
  arrange(speaker, desc(word_count))
</code></pre>
<pre><code class="language-r">categorized_filtered &lt;- categorized_words %&gt;%
  filter(category != &quot;Other&quot;)

proportions_by_category &lt;- categorized_filtered %&gt;%
  group_by(speaker, category) %&gt;%
  summarise(word_count = n(), .groups = &quot;drop&quot;) %&gt;%
  group_by(speaker) %&gt;%
  mutate(proportion = word_count / sum(word_count)) %&gt;%
  arrange(speaker, desc(proportion))
</code></pre>
<pre><code class="language-r">ggplot(proportions_by_category, aes(x = speaker, y = proportion, fill = category)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;stack&quot;) +
  scale_y_continuous(labels = scales::percent_format()) + 
  theme_minimal() +
  labs(
    title = &quot;Proportion of Words by Category &quot;,
    x = &quot;Speaker&quot;,
    y = &quot;Proportion of Words&quot;,
    fill = &quot;Category&quot;
  ) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),  
    legend.title = element_text(size = 12),             
    legend.text = element_text(size = 10)              
  )
</code></pre>
<img src="https://example.org/post/2024/12/10/post-campaign-narrative/index_files/figure-html/unnamed-chunk-8-1.png" width="672" />
<pre><code class="language-r">pivoted_table &lt;- proportions_by_category %&gt;%
  select(speaker, category, proportion) %&gt;%  
  pivot_wider(
    names_from = category, 
    values_from = proportion,  
    values_fill = 0  
  )

kable(
  pivoted_table, 
  format = &quot;html&quot;, 
  col.names = c(&quot;Speaker&quot;, &quot;Economy&quot;, &quot;Domestic Policy&quot;, &quot;Foreign Policy&quot;, &quot;Character&quot;), 
  caption = &quot;Proportion of Words by Speaker and Category (Excluding 'Other')&quot;,
  digits = 3  
) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;), full_width = FALSE) %&gt;%
  column_spec(1, bold = TRUE)
</code></pre>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption><span id="tab:unnamed-chunk-9"></span>Table 1: Proportion of Words by Speaker and Category (Excluding 'Other')</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Speaker </th>
   <th style="text-align:right;"> Economy </th>
   <th style="text-align:right;"> Domestic Policy </th>
   <th style="text-align:right;"> Foreign Policy </th>
   <th style="text-align:right;"> Character </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Gallego </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Harris </td>
   <td style="text-align:right;"> 0.621 </td>
   <td style="text-align:right;"> 0.276 </td>
   <td style="text-align:right;"> 0.069 </td>
   <td style="text-align:right;"> 0.034 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Lake </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.000 </td>
  </tr>
  <tr>
   <td style="text-align:left;font-weight: bold;"> Trump </td>
   <td style="text-align:right;"> 0.621 </td>
   <td style="text-align:right;"> 0.242 </td>
   <td style="text-align:right;"> 0.126 </td>
   <td style="text-align:right;"> 0.011 </td>
  </tr>
</tbody>
</table>

</main>

  <footer>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="//cdn.jsdelivr.net/combine/npm/katex/dist/katex.min.js,npm/katex/dist/contrib/auto-render.min.js,npm/@xiee/utils/js/render-katex.js" defer></script>

<script src="//cdn.jsdelivr.net/npm/@xiee/utils/js/center-img.min.js" defer></script>

  
  <hr/>
  © <a href="https://yihui.org">Yihui Xie</a> 2017 &ndash; 2024 | <a href="https://github.com/yihui">Github</a> | <a href="https://twitter.com/xieyihui">Twitter</a>
  
  </footer>
  </body>
</html>

